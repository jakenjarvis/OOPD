# AIとの連携を効率化・高度化する Object-Oriented Prompt Design (OOPD) 入門

## はじめに：OOPDとは何か？ AIへの指示を構造化する新アプローチ

Large Language Models (LLM) に対して、複雑な役割を担わせたり、特定の構造に基づいて情報を整理させたりする際、指示の明確さや一貫性を保つことに課題を感じることはありませんか？ 指示が曖昧だと期待通りの結果が得られなかったり、対話が長くなるにつれて以前の指示との整合性が取れなくなったりする状況が考えられます。

こうした課題に対応するため、**Object-Oriented Prompt Design (OOPD)** という新たな手法を提案します。OOPDは、ソフトウェア工学における「オブジェクト指向プログラミング (OOP)」の概念を応用し、AIへの指示（プロンプト）を**構造的に設計・管理**することを目指します。

OOPDを導入することで、以下のような利点が期待できます。

- **指示の明確化:** 複雑な要求事項を論理的に整理し、曖昧さを排除します。
- **一貫性の向上:** 一度定義した構造に基づき、AIはより一貫性のある応答や動作を示すようになります。
- **再利用性の実現:** 作成した定義（クラスなど）は、他のプロンプトや対話セッションで再利用可能です。
- **保守性の改善:** 指示内容の修正や拡張が容易になります。
- **AIによる主体的な支援:** ユーザーの大まかな指示に基づき、AIが詳細な構造を提案・補完します。

本記事では、OOPDの基本的な考え方を解説し、Google AI Studioを用いて「**AIにペルソナの設計図（クラス）を作成させ、そのペルソナとして応答させる**」実践的な例を通じて、OOPDの第一歩を体験します。

## OOPDの基本概念：クラス、プロパティ、インスタンス

「オブジェクト指向」という言葉に馴染みがない方もいるかもしれませんが、OOPDで利用するのはその核となる考え方です。AIに対して、物事の構造的な「**設計図（クラス）**」を理解させる、と捉えると分かりやすいでしょう。

- **クラス (Class):** 対象となる概念の「設計図」や「型」です。例えば、「ペルソナ」というクラスは、様々なキャラクターに共通する要素（名前、性格、口調など）を定義します。
- **プロパティ (Property):** クラスが持つ「属性」や「データ項目」です。「ペルソナクラス」であれば、「名前」「性格」「口調」「背景設定」「専門知識」などが該当します。
- **オブジェクト/インスタンス (Instance):** クラスという設計図に基づいて生成された、具体的な「実体」です。「ペルソナクラス」から作られた「特定の名前と性格を持つキャラクターA」や「別の特徴を持つキャラクターB」がインスタンスにあたります。

OOPDの特徴は、ユーザーが「こういうクラスが欲しい」と大まかに指示するだけで、**AIがこれらの概念に基づき、詳細なクラス定義を提案してくれる**点にあります。この定義はMarkdown形式で記述され、AI自身の振る舞いを制御するための指示書として機能します。

OOPDには主に2つの記述フォーマットが存在します。

- **ユーザーフォーマット:** より柔軟性が高く、主にセッション内での利用や試行錯誤に適しています。
- **定義フォーマット:** より厳密な形式で、定義の共有や再利用に適しています。

本チュートリアルでは、まず **ユーザーフォーマット** を用いてOOPDを体験します。

## Google AI Studioの準備とSystem Instructionsの設定

このチュートリアルでは、Googleが提供するLLM開発プラットフォーム **Google AI Studio** を使用します。（他のAIプラットフォームでも構いません）

1. **Google AI Studioへのアクセス:**
   Webブラウザで [Google AI Studio](https://aistudio.google.com/) にアクセスしてください。（Googleアカウントが必要です）
2. **新規プロンプトの作成:**
   ログイン後、左の「Chat」を選び、新しいプロンプトを作成できる状態にします。
3. **System Instructionsの設定（重要）:**
   OOPDのルールをAIに正確に認識させるため、**System Instruction**欄にOOPDの基本指示を設定します。これは、AIに対する基本的な前提知識や動作ルールを伝えるための重要なステップです。
   - **指示内容の取得:** OOPDの公式GitHubリポジトリにある [instructions/system\_instructions\_ja.md](https://raw.githubusercontent.com/jakenjarvis/OOPD/refs/tags/v0.7.2/instructions/system_instructions_ja.md) ファイルの内容が必要です。
     上記のファイルを開き、その内容**全体**をコピーしてください。
   - **Google AI Studioへの貼り付け:** Google AI Studioの画面上部にあるSystem Instructionの入力欄（「Edit system instruction」をクリックして開く）に、コピーした内容を**そのまま貼り付け**ます。
   - **保存:** 入力欄の外側をクリックするなどして、設定を保存します。

これで、AIはOOPDの基本的なルールセットを理解した状態で対話を開始する準備が整いました。

**補足:**
OOPDの各種ドキュメント（本記事で紹介する内容を含む）の日本語訳は、公式GitHubリポジトリの [docs/ja](https://github.com/jakenjarvis/OOPD/tree/main/docs/ja) ディレクトリ配下に格納されています。より詳細な仕様を確認したい場合は、こちらも参照してください。

## 実践：AIによる「ペルソナクラス」の自動生成

それでは、AIに詳細なペルソナの設計図（ペルソナクラス）を作成させてみましょう。ユーザーが行う指示は非常にシンプルです。

以下の短い指示をコピーし、Google AI Studioのプロンプト入力欄（System Instruction欄の下にある、通常のプロンプト入力欄）に貼り付けてください。

```
OOPDのユーザーフォーマットで、詳細な設定項目を持つ「ペルソナクラス」を作って提案してください。
```

この指示を受け取ったAIは、System Instructionで与えられたOOPDの知識に基づき、ペルソナを定義する上で有用と考えられる様々なプロパティ（項目）を含むクラス定義を**自ら考察し、提案**します。

Google AI Studioの実行ボタン（通常は「Run」）を押すと、AIは次のような応答を生成するでしょう。（AIモデルや実行タイミングにより、提案内容は変動します）

```
承知いたしました。ユーザーフォーマットで、詳細な設定項目を持つ「ペルソナクラス」を提案します。
様々な側面からペルソナを定義できるよう、多様なプロパティを検討しました。

#### ペルソナクラス: キャラクターの個性や背景を定義するクラス

このクラスは、対話AIや物語の登場人物などのペルソナを詳細に設定するために使用します。

**プロパティ:**

- `名前: String`: ペルソナのフルネームです。
- `ニックネーム: String, オプション`: 愛称や通称があれば指定します。
- `年齢: Number`: ペルソナの年齢です。
- `性別: String`: ペルソナの性別（例: 男性, 女性, 指定なし）。
- `性格: String`: ペルソナの主要な性格特性を記述します（例: 明るい, 冷静, 好奇心旺盛）。MBTIなどを参考にしても良いでしょう。
- `口調: String`: 話し方の特徴（例: 丁寧語, フランク, 関西弁, 古風）。具体的なセリフ例を含めても良いです。
- `一人称: String`: 自分を指す言葉（例: 私, 俺, 僕, わし）。
- `職業: String`: ペルソナの職業や役割。
- `背景設定: String`: ペルソナの経歴、出身地、家族構成などのバックストーリー。
- `価値観: String`: ペルソナが重要視すること、信念。
- `目標: String`: ペルソナが達成しようとしていること。
- `特技: String`: ペルソナが得意なこと、特殊能力。
- `弱点: String`: ペルソナが苦手なこと、弱み。
- `外見的特徴: String`: 髪の色、目の色、服装など、見た目の特徴。
- `専門知識: String, オプション`: 特定分野に関する知識レベル（例: AI技術に精通, 歴史マニア）。
- `人間関係: String, オプション`: 他のペルソナとの関係性。
- `秘密: String, オプション`: 他者に知られていない情報。
- `感情表現: String`: 喜怒哀楽の表し方の特徴。

この内容でよろしいでしょうか？ 不要なプロパティがあれば削除、追加したいプロパティがあればお申し付けください。
```

ユーザーは簡単な指示を出しただけですが、AIがこれほど詳細なクラス定義を提案してくれました。これがOOPDを活用する利点の一つです。

提案内容に問題がなければ、「それで承認します」や「OKです」のように返信します。もし修正が必要であれば、「秘密プロパティは削除してください」や「新たに『好きな音楽ジャンル』プロパティを追加してください」のように具体的に指示することで、AIは定義を修正します。

## ペルソナインスタンスの生成と活用

クラス定義（設計図）が確定したら、次はこの設計図に基づいて、AIに具体的なペルソナ（インスタンス）を複数作成させ、そのペルソナとして応答させてみましょう。

AIに続けて、以下のように指示します。

```
承認したペルソナクラス定義に基づき、ランダムなペルソナを3人作成してください。
```

AIは、確定したペルソナクラスの各プロパティに対してランダムな値を設定し、3人の個性的なペルソナ（インスタンス）情報を生成して提示します。

（AIによるペルソナ生成例 - 実際の内容はランダムに生成されます）

```
承知いたしました。ペルソナクラス定義に基づき、ランダムなペルソナを3名作成します。

**ペルソナ1:**
- 名前: 佐藤 健太 (Sato Kenta)
- 年齢: 28
- 性別: 男性
- 性格: 実直で努力家。やや内向的だが、信頼できる人物。
- 口調: 標準的な丁寧語。「〜です。」「〜ます。」が基本。
- 一人称: 僕
- 職業: システムエンジニア
- 背景設定: 地方の工業高校を卒業後、都内のIT企業に就職。地道にスキルを磨いてきた。
- 価値観: 誠実さ、責任感。
- 目標: プロジェクトリーダーとしてチームを成功に導くこと。
- 特技: 複雑なアルゴリズムの理解、デバッグ。
- 弱点: 人前で話すこと、突発的な変化への対応。
- 外見的特徴: 黒髪で眼鏡をかけている。シンプルな服装。
- 専門知識: Java、データベース設計。

**ペルソナ2:**
- 名前: 高橋 美咲 (Takahashi Misaki)
- 年齢: 35
- 性別: 女性
- 性格: 明るく社交的。リーダーシップがあり、周りを巻き込むのが得意。
- 口調: ハキハキとしたビジネス口調。時折、関西弁が混じる。「〜やねん！」「それで、〜しましょうか。」
- 一人称: 私
- 職業: マーケティングマネージャー
- 背景設定: 大学卒業後、広告代理店を経て現在の食品メーカーに転職。数々のヒット商品を手掛ける。
- 価値観: 結果を出すこと、チームワーク。
- 目標: 新ブランドを立ち上げ、市場シェアNo.1を獲得すること。
- 特技: プレゼンテーション、企画立案、人脈作り。
- 弱点: 細かい事務作業、単調な作業。
- 外見的特徴: 明るい色のセミロングヘア。洗練されたオフィスファッション。
- 専門知識: マーケティング戦略、ブランディング、消費者心理。

**ペルソナ3:**
- 名前: 伊藤 聡 (Ito Satoshi)
- 年齢: 52
- 性別: 男性
- 性格: 温厚で聞き上手。豊富な経験に基づいた的確なアドバイスをする。
- 口調: 穏やかで落ち着いた話し方。「〜ですねぇ。」「まあ、焦らずとも大丈夫ですよ。」
- 一人称: 私（わたし）
- 職業: カフェのマスター
- 背景設定: 若い頃は世界中を旅していた。様々な経験を経て、10年前に念願のカフェを開業。
- 価値観: 人との出会い、心地よい空間を提供すること。
- 目標: 地域の人々にとっての「止まり木」のような存在であり続けること。
- 特技: 美味しいコーヒーを淹れること、人の話を聞くこと、雑学。
- 弱点: 体力的な衰え、早起き。
- 外見的特徴: 白髪混じりの髪。優しい目元。落ち着いた色合いのシャツとエプロン。
- 専門知識: コーヒー豆の種類と淹れ方、世界の文化・地理。
```

これで、クラス定義に基づいた具体的なキャラクターが3名生成されました。

最後に、AIにこれらのペルソナになりきって応答させてみましょう。

```
今作成した3人のペルソナとして、それぞれの立場から簡単な自己紹介を行ってください。
```

この指示を実行すると、AIは各ペルソナの性格、口調、背景などを考慮して、自己紹介文を生成します。

（AIによる自己紹介例）

```
承知いたしました。それぞれのペルソナとして自己紹介を行います。

**佐藤 健太:**
「あ、どうも。佐藤健太です。28歳で、システムエンジニアをやっています。えっと、人前で話すのは少し苦手なんですが…仕事は真面目に取り組む方だと思います。Javaとかデータベースが得意です。よろしくお願いします。」

**高橋 美咲:**
「こんにちは！高橋美咲です！35歳、マーケティングマネージャーやってます！面白い企画を考えるのが大好きで、チームで結果出すことに燃えるタイプやねん！プレゼンなら任せてください！どうぞ、よろしゅうお願いします！」

**伊藤 聡:**
「いらっしゃいませ。私は伊藤と申します。52歳で、この街で小さなカフェを営んでおります。若い頃はいろいろと見て回りましてねぇ。今は美味しいコーヒーを淹れて、お客様のお話を聞くのが何よりの楽しみです。どうぞ、ごゆっくりしていってください。」

```

このように、OOPDを用いることで、簡単な指示からAIに複雑な役割設定（クラス定義）を生成させ、その定義に基づいて具体的な情報（インスタンス）を作成し、さらにその役割として一貫した応答をさせることが可能になります。

## メソッドとイベント：ペルソナに「動き」を与える

さて、ここまではペルソナの「属性（プロパティ）」を中心に定義してきました。OOPDでは、これに加えてペルソナの「**操作（メソッド）**」や「**出来事（イベント）**」も定義することで、AIの振る舞いをさらに豊かに、そして動的にコントロールできます。

- **メソッド (Method):**
  - **意味:** ペルソナ（オブジェクト）が実行できる「アクション」や「能力」を表します。
  - **OOPDでの役割:** AIに特定の「行動」や「処理」を実行させるための指示となります。
  - **例 (ペルソナクラス):**
    - `自己紹介する()`: ペルソナが自身の情報に基づいて自己紹介を行う。
    - `情報を分析する(分析対象データ: String): String`: 与えられたデータを分析し、結果を返す。
    - `感情を表現する(感情タイプ: String)`: 特定の感情を表に出す。
  - **記述方法 (ユーザーフォーマット):** クラス定義内に `**メソッド:**` というセクションを設け、`- メソッド名(引数): 戻り値型` の形式で記述します。（型指定は推奨ですが必須ではありません）

- **イベント (Event):**
  - **意味:** ペルソナ（オブジェクト）の内部で「何かが起こった」ことを外部に通知する仕組みです。
  - **OOPDでの役割:** 特定の「状態変化」や「トリガー」が発生したことをAIに認識させ、それに応じた応答や後続処理を促すための指示となります。
  - **例 (ペルソナクラス):**
    - `機嫌が変わった(新しい機嫌: String)`: ペルソナの機嫌が変化したことを示す。
    - `新しい情報を得た(情報内容: String)`: ペルソナが新たな知識や情報を獲得した。
    - `目標を達成した()`: ペルソナが設定された目標を達成した。
  - **記述方法 (ユーザーフォーマット):** クラス定義内に `**イベント:**` というセクションを設け、`- イベント名(引数)` の形式で記述します。（通常、戻り値はありません）

これらのメソッドやイベントをクラス定義に追加することで、「佐藤健太にこのデータを分析させて」とか、「高橋美咲が目標を達成したら、特別なセリフを言わせて」といった、より具体的で状況に応じた指示をAIに与えることが可能になります。

**試しにAIに指示してみましょう:**

```
先ほどのペルソナクラスに、挨拶と特技使用メソッド、好感度変化イベントを追加してください。
```

```
承知いたしました。ユーザーフォーマットで定義されたペルソナクラスに、ご指定のメソッドとイベントを追加します。

**メソッド:**
- `挨拶する(): String`: 時間帯に応じた挨拶を返す。
- `特技を使う(対象: String): String`: 定義された特技を使って、対象に何かを行う。結果を文字列で返す。

**イベント:**
- `好感度が変化した(変化量: Number)`: 他のキャラクターに対する好感度が変化した。
```

このように指示すれば、AIはクラス定義を更新し、これらの新しい振る舞いや状態変化を認識できるようになります。

## 定義の出力とフォーマット変換

AIとの対話を通じて作成・修正してきたクラス定義は、AIが内部的に記憶・管理しています。この定義を、後で確認したり、別の場所で再利用したりするために、整形されたOOPD形式で出力させることができます。

- **ユーザーフォーマットでの出力:**
  現在の作業内容を、柔軟なユーザーフォーマットのまま出力させたい場合は、以下のように指示します。
  ```
  現在のペルソナクラス定義をOOPDユーザーフォーマットで出力してください。
  ```
  AIは、最新のクラス定義（プロパティ、メソッド、イベントを含む）を、ユーザーフォーマットのルールに従ってMarkdown形式で提示します。

- **定義フォーマットへの変換と出力:**
  作成した定義を他の人と共有したり、より厳密な形式で保存・再利用したりしたい場合は、定義フォーマットへの変換を指示します。

  ```
  現在のペルソナクラス定義をOOPD定義フォーマットに変換して出力してください。
  ```

  この指示により、AIは以下の処理を行います。

  1. 各要素（クラス名、プロパティ名、メソッド名など）に対して、内部的に推論・管理していた英語の**ハブ名**を決定します。
  2. 決定した英語ハブ名と、標準的な日本語名を**併記**します。（例: `#### ペルソナクラス (Persona): ...` や `- name::氏名: String`）
  3. モジュール定義（例: `## com.example.persona`）など、定義フォーマットで必須とされる要素を補完します。
  4. 定義フォーマットの厳密なルールに従って、全体の構造を整形し、Markdownコードブロック（`~~~markdown ... ~~~`）で囲って出力します。

  定義フォーマットで出力された定義は、言語の壁を越えて共有可能であり、より堅牢なプロンプト設計の基盤となります。

これらの出力機能を使うことで、AIとの対話を通じて作り上げた設計図を、目的に応じて適切な形式で取り出すことができます。

## まとめ：OOPDによるAI連携の新たな可能性

Object-Oriented Prompt Design (OOPD)は、AIへの指示を構造化し、その解釈と応答の一貫性を高めるための効果的なフレームワークです。特に、複雑な設定や役割分担が求められる場面において、ユーザーの指示の手間を削減し、AIが主体的に詳細を補完・管理することで、より効率的かつ高度なAIとの連携を実現します。メソッドやイベントを活用することで、さらに動的なAIの振る舞いをデザインすることも可能です。定義の出力機能を活用すれば、作成した設計図の再利用性も高まります。

ぜひ、OOPDを試し、AIとの対話や共同作業における新たな可能性を感じてみて下さい。
