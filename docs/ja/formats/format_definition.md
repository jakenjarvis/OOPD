### OOPD形式: 定義フォーマット (Definition Format) 仕様

#### 定義フォーマットとは

定義フォーマットは、OOPDに基づいて作成された定義を、**他者と共有したり、異なるセッションや環境で再利用したりするための、厳格で正式な記述形式**です。定義の確定版であり、言語間での**可逆性**と解釈の**一貫性**を保証することを目的とします。

#### このドキュメントについて

このドキュメント (`format_definition.md`) は、定義フォーマットに特有の厳格なルールについて説明します。共通のルールについては `format_common.md` を参照してください。定義フォーマットは、プロンプトの記述言語に関わらず、以下のルールに従う必要があります。

#### 必須ルールと書式

- **英語ハブ名の併記:**
  - クラス名、インターフェース名、列挙型名など、AIによる翻訳対象となる「翻訳用語」については、**必ず確定した英語ハブ名を併記**する必要があります。詳しくは以下の個別の記述方法を参照してください。
  - 英語ハブ名は、`english_specification.md` で定義された**英語命名規則**に従います。
  - 翻訳用語の母国語表記は、対象言語の翻訳ルール (`translation_rules/` 内) で定義された**標準命名規則**に従います。
- **厳密な命名規則の適用:**
  - 上記の通り、母国語名と英語ハブ名の両方について、それぞれの言語で定義された**標準命名規則を厳密に適用**する必要があります。
  - モジュール名は、`english_specification.md` で定義された英語命名規則に従い、グローバルな一意性を確保することが強く推奨されます。
- **英語ハブ名と母国語名の認識:**
  - AIは、定義に `{英語ハブ名}::{母国語名}` の形式で併記されている要素について、**英語ハブ名と母国語名の両方を、その要素を指す有効な識別子として認識**します。
- **クロス参照:**
  - **同一モジュール内:** 参照したいクラス名などを、**母国語名のみ**で記述します。AIは文脈からモジュール内の定義を特定します。
  - **異なるモジュール:** 参照したいクラス等が別のモジュールに属する場合、**必ず完全修飾名 (`モジュール名.クラス名`)** で指定する必要があります。型指定の場合も同様です。（例: `作成者 (com.example.common.User)`）
- **説明文の推奨:**
  - 各モジュール、セクション、クラス、インターフェース、メソッド、プロパティなどには、その目的や意味を明確にするための**説明文を記述することを強く推奨**します。AIの解釈補助や人間による理解促進に役立ちます。説明文はプロンプト記述言語で記述します。
- **モジュール定義 (`##`):**
  - 全ての定義は必ずモジュール内に記述する必要があります。
  - 書式: `## {英語モジュール名}`
  - モジュール名はグローバルな一意性が推奨されます (`english_specification.md`参照)。
  - モジュールの母国語名や詳細な説明文は、`##` 行の下に通常のテキストとして記述できます（オプション）。
- **見出し (クラス `####`, インターフェース `####`, セクション `###`):**
  - **クラス/インターフェース:**
    - 書式: `{見出しレベル} {母国語名} ({英語ハブ名}): {簡易説明文}`
    - **簡易説明文は必須**です。
    - 見出し行の下に、**詳細な説明文**を通常のテキストとして記述できます（オプション）。
  - **セクション:**
    - 書式: `{見出しレベル} {母国語名} ({英語ハブ名})` または `{見出しレベル} {母国語名} ({英語ハブ名}): {説明文}`
    - **説明文は省略可能**です。
  - **英語が母国語の場合:** `{英語名}` のみとなり、英語ハブ名の括弧は不要です。説明文のルールは上記と同様です。
- **要素名 (プロパティ名、メソッド名、イベント名、列挙型定義名、列挙型値、構造体クラス定義名):**
  - 母国語が「主」、英語ハブ名が「副」となります。
  - 英語ハブ名を**接頭辞**として、ダブルコロン `::` で母国語名に接続します。
  - 基本形式: `{英語ハブ名}::{母国語名}`
  - **英語が母国語の場合:** 接頭辞 (`{英語ハブ名}::`) は省略し、英語名のみを記述します。
- **リスト形式要素 (プロパティ、メソッド、イベント、列挙型、構造体) の定義:**
  - 行頭にMarkdownリストのハイフン `-` を付けます。
  - **バッククォート ``` ` ``` の適用範囲:**
    - **プロパティ、メソッド、イベント:** 定義の主要部分（ハイフン直後に半角スペースを空けた後から型/戻り値指定まで）**のみ** を囲みます。
      - 開始: リストのハイフン(`-`)の後ろに半角スペース１文字を空けた後。要素定義の直前。
      - 終了: 要素定義の直後にコロン(`:`)、コロンの後ろに半角スペース。コロンと説明文はバッククォートで囲みません。
    - **列挙型、構造体:** 要素名の部分（`{英語ハブ名}::{母国語名}` または `{英語名}`）**のみ**を囲みます。
      - 開始: リストのハイフン(`-`)の後ろに半角スペース１文字を空けた後。要素定義の直前。
      - 終了: 要素定義の直後にコロン(`:`)、コロンの後ろに半角スペース。コロンと説明文や値リストはバッククォートで囲みません。
      - 列挙型の値リストはバッククォートで囲みません。
- **プロパティ定義:**
  - 書式 (母): `- `{英語ハブ名}::{母国語名}: {型名}`: {説明}`
  - 書式 (英): `- `{英語名}: {型名}`: {説明}`
  - **オプション項目:**
    - プロパティ定義では、型名の後に `, {オプション指示子}` を追記することで任意項目を示すことができます（オプション指示子の用語は `core.md` 参照）。
      - 例 (日本語): `- プロパティ名: String, オプション`
      - 例 (英語): `- propertyName: String, Optional`
- **メソッド定義:**
  - 書式 (母): `- `{英語ハブ名}::{母国語名}({引数リスト}): {戻り値型名}`: {説明}`
  - 書式 (英): `- `{英語名}({引数リスト}): {戻り値型名}`: {説明}`
  - **戻り値:** `Void` は省略可能ですが、**記載を推奨**します。型名には英語ハブ名を付けません。
  - **引数リスト:** カンマ区切りで `{引数名}: {型名}` または `{引数名}: {型名} = {初期値}`。引数名、型名、初期値には英語ハブ名を付けません。
  - **デフォルト値:**
    - メソッド定義では、引数の型名の後に `= {初期値}` を追記することでデフォルト値を表現できます。リテラル値 (`True`, `False`, `Null`, 数値, 文字列) のみが推奨されます。
      - 例 (日本語): `- メソッド名(引数名: Number = 0): Void`
      - 例 (英語): `- methodName(argumentName: Number = 0): Void`
- **イベント定義:**
  - 書式 (母): `- `{英語ハブ名}::{母国語名}({引数リスト})`: {説明}`
  - 書式 (英): `- `{英語名}({引数リスト})`: {説明}`
  - **戻り値:** 通常 `Void` ですが、**記載の省略を推奨**します。
  - 引数リストのルールはメソッドと同じです。
- **列挙型定義:**
  - 書式 (母): `- `{英語ハブ名}::{母国語名}`: {値リスト}`
  - 書式 (英): `- `{英語名}`: {値リスト}`
  - **値リスト:** カンマ区切りで `{英語ハブ名}::{母国語名}`（または英語のみ）形式の値を列挙します。
- **構造体クラス定義 (推測):**
  - 書式 (母): `- `{英語ハブ名}::{母国語名}`: {説明}`
  - 書式 (英): `- `{英語名}`: {説明}`
- **基底クラスとインターフェースの実装:**
  - `format_common.md` に記載の通り、**言語ごとの基本用語**を使用します。
  - **継承:**
    - 書式 (日本語例): `**基底クラス:** {基底クラス名} ({英語基底クラス名})`
    - 書式 (英語例): `**Base Class:** {BaseClassName}`
  - **インターフェース実装:**
    - 書式 (日本語例): `**インターフェース:** {インターフェース名} ({英語インターフェース名}), ...`
    - 書式 (英語例): `**Interfaces:** {InterfaceName}, ...`
  - クラス名やインターフェース名は、**母国語名のみ**を記述し、英語ハブ名は付けません（カンマ区切りで複数指定可）。
- **型の参照:**
  - プロパティや引数、戻り値で型を指定する際、ユーザー定義クラスや列挙型を参照する場合も、**母国語名のみ**を記述し、英語ハブ名は付けません。

#### 出力ルール

- AIが `定義フォーマット` で出力を指示された場合は、**必ずOOPD形式(Markdown形式)の出力全体をコードブロック「\`\`\`」を使用して囲んで表示**してください。
- インスタンスのデータを出力する際は、標準として**YAML形式のコードブロック（`---yaml` ... `---`）**で出力します。ユーザーが別途指示をした場合はJSON等の他の形式でも構いません。

#### 定義フォーマットの確定プロセス

- 通常、`定義フォーマット` は、ユーザーが `ユーザーフォーマット` で作成した内容を基に、AIに生成を指示します。
- AIは生成時に、上記の必須ルール（英語名併記、命名規則、モジュール所属など）への準拠を自動チェックします。
- チェックで問題が見つかった場合（例: 命名規則違反、英語名不明瞭、モジュール未定義など）、AIはユーザーに問題点を指摘し、修正を促します。AIが修正案を提示する場合もあります。
- ユーザーがAIとの対話を通じて問題を解消し、内容を確認・承認することで、`定義フォーマット` が確定します。
