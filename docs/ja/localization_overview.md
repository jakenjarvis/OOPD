## OOPD ローカライゼーション概要 (Localization Overview)

### 概要

このドキュメントは、Object-Oriented Prompt Design (OOPD) における多言語対応（ローカライゼーション）の基本的な考え方と戦略について説明します。OOPDは、世界中のユーザーが自身の母国語でプロンプトを設計し、AIと効果的に対話し、作成した定義を言語の壁を越えて共有できることを目指しています。

### 目標

- **母国語での記述:** ユーザーは原則として、自身の母国語でOOPD形式（特に `ユーザーフォーマット`）を記述できます。
- **定義の共有:** 異なる言語で作成されたOOPD定義 (`定義フォーマット`) を、他の言語の話者やAIが正確に理解し、再利用できること。
- **AIによる解釈:** AIがユーザーの母国語で書かれたプロンプトの構造と意図を正確に解釈できること。
- **一貫性のある翻訳:** AIが内部で情報を処理し、応答を生成する際に、用語や概念の翻訳に一貫性を保つこと。

### ハブ言語モデル

OOPDでは、多言語間の翻訳と内部処理の一貫性を確保するために、**英語 (`en`) をハブ言語**として採用しています。

1. **入力:** ユーザーが母国語でプロンプトを入力します。
2. **内部変換:** AIはプロンプト内の「翻訳用語」を解釈し、内部的に英語ハブ言語の表現に変換・管理します。
3. **処理:** AI内部での思考、推論、応答生成は、この英語ハブ表現を基準に行われます。
4. **出力:** AIは生成した応答を、英語ハブ表現から、ユーザーが指定した出力言語（または入力言語）へ翻訳して提示します。

### 用語の分類と扱い

OOPDで使われる用語は、翻訳の観点から2種類に分類されます (`core.md` 参照)。

- **基本用語 (Basic Terms):** `Class`, `Method`, `Property` など、OOPDの構造を定義するコア概念。これらは**固定キーワード**であり、**翻訳されません**。各言語で定められた固定表記がそのまま使われます。標準型、拡張型、リテラルも同様に扱われ、常に英語表記が使用されます。
- **翻訳用語 (User-Defined Identifiers):** ユーザーが定義するクラス名、インターフェース名、メソッド名、プロパティ名、イベント名、列挙型定義名、列挙型値など。これらはAIによって**翻訳処理の対象**となります。

### 翻訳処理

AIによる翻訳処理は、以下の原則とルールに基づいて行われます。

- **対象:** プロンプト内の構造定義に含まれる「翻訳用語」のみ。
- **タイミング:**
  - **入力解釈時:** 母国語で記述された内容を英語ハブ言語へ推論・変換します。
  - **名称初期決定時:** 説明文や文脈を参照して最適な英語名を推論可能です。
  - **応答生成時:** 英語ハブ言語から指定された出力言語へ翻訳します。確定定義の翻訳では説明文を参照しません（可逆性のため）。
- **一貫性の確保 (セッション内記憶):**
  - AIは**セッション内で翻訳用語とその英語ハブ名の対応関係を記憶**します。 *(セッションの定義については `core.md` を参照)*
  - 同じセッション内で同じ翻訳用語（または同義とAIが判断した表現）が出現した場合、**必ず記憶した英語ハブ名を使用**し、翻訳の揺らぎを防ぎます。これが最優先されます。
- **翻訳ルール:**
  - 翻訳は、各言語ペアごとに定義された**命名規則**と**翻訳パターン**に基づいて行われます。詳細は `translation_rules` ディレクトリ内の各言語ルールファイル (`{language_code}_rules.md`) を参照してください。
  - **多言語間の概念マッピング:** 異なる言語で同じ概念を表す用語については、AIはクラス定義、説明文、および各言語の翻訳ルールを参照し、意味的な類似性に基づいて共通の英語ハブ名にマッピングするよう努めます。
  - **表現の対応関係 (N対N, 1対N, N対1 の扱い):**
    - **N対N (推奨):** ハブ言語とターゲット言語間で、表現のニュアンスが異なる場合（例: ハブ言語の `isCompleted` と `hasFinished` のようにニュアンスが異なる複数の表現がある場合）、可能な限りターゲット言語 `xx` でも、それぞれに対応する異なる標準訳 `xx_StandardTranslation1` と `xx_StandardTranslation2` を定義します。これにより、言語間の情報量をできるだけ維持します。
    - **1対N (要注意):** ハブ言語の1つの単語 `TermA` がターゲット言語 `xx` では文脈によって `xx_TranslationB` と `xx_TranslationC` のように複数の意味に解釈できる場合、安易に訳し分けると逆翻訳時に `TermA` に戻らない可能性があります。この場合、最も代表的な標準訳 `xx_TranslationB` を1つ定めるか、ハブ言語側で `TermA_Context1`, `TermA_Context2` のように、より具体的な表現を使うことを推奨します。
    - **N対1 (許容):** 逆に、ハブ言語の類義語 `TermX` と `TermY` がターゲット言語 `xx` では区別が困難または不自然な場合、ターゲット言語側では `xx_StandardTranslationZ` のように、**1つの標準訳に集約**することがあります。
  - **ターゲット言語からハブ言語への標準化:** ターゲット言語から英語ハブへ変換する際は、ターゲット言語 `xx` の表現 `xx_Expression1` と `xx_Expression2` が同じ概念を指す場合、ハブ言語へ変換する際には、原則として `HubTermAlpha` のような**1つの標準的な英語ハブ名を生成**するように努めます。これにより、英語ハブ言語側での表現の一貫性を保ちます。
- **コア対訳リスト:**
  - **原則不要。** 基本的な単語も、ルールとAIの言語能力による翻訳に委ねます。
  - **例外:** リテラル (`True`, `False`, `Null` は英語表記に固定）など、表記揺れを絶対に避けたいごく一部の語彙については、例外的に固定訳を定義します。
- **AI推論の役割:**
  - ルールや（例外的な）コアリストでカバーできない未知の語彙、複雑な表現については、AIが文脈や言語知識に基づいて最適な翻訳を**推論**します。
  - 翻訳結果の自然さの調整（例: 語順、活用など）もAIが行います。
- **自然言語解析適合性:** 翻訳ルールでは、生成されるターゲット言語の名称が、その言語の文法構造の中でAIが自然言語指示文の一部として識別しやすい単語/句になるように考慮されます（例: 不自然な助詞の混入を避けるなど）。

### 翻訳範囲の限定

AIによる翻訳処理は、OOPD形式の構造定義部分（クラス名、メソッド名など）に限定されます。ユーザーがAIに生成を依頼する**コンテンツ本文（物語、レポートなど）は翻訳対象外**です。

### 可逆性について

OOPDは、特に `定義フォーマット` において、異なる言語間で定義の意味が変わらないこと（**意味的な可逆性**）を重視します。

- `定義フォーマット` では英語ハブ名が併記されるため、ハブ言語レベルでの同一性は常に保証されます。
- しかし、上記の翻訳ルール（特に N対1 やターゲット言語からハブ言語への標準化）により、ある言語から別の言語に翻訳し、それを元の言語に戻した場合に、**字句レベル（単語レベル）での完全な一致が保証されない場合がある**ことに注意してください。
- 目指すのはあくまで、定義の**意図や構造が変わらない「意味的な可逆性」**です。

### フォーマットと翻訳

- **ユーザーフォーマット (`User Format`):** 母国語のみで記述。AIが内部で英語ハブ名を推論・管理。
- **定義フォーマット (`Definition Format`):** 標準化された母国語名と確定した英語ハブ名を併記。言語間で共有可能。この形式を介することで、異なる言語間の定義変換が可能になります。

### 貢献

新しい言語への対応（翻訳ルールの作成）や、既存ルールの改善に関する貢献を歓迎します。`translation_rules` ディレクトリ以下の各言語ファイルが、翻訳の精度と品質の鍵となります。
