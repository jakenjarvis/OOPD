# OOPD形式: 定義フォーマット (Definition Format) 仕様

## 定義フォーマットとは

定義フォーマットは、OOPDに基づいて作成された定義を、**他者と共有したり、異なるセッションや環境で再利用したりするための、厳格で正式な記述形式**です。定義の確定版であり、言語間での**可逆性**と解釈の**一貫性**を保証することを目的とします。

## このドキュメントについて

このドキュメント (`format_definition.md`) は、定義フォーマットに特有の厳格なルールについて説明します。共通のルールについては `format_common.md` を参照してください。定義フォーマットは、プロンプトの記述言語に関わらず、以下のルールに従う必要があります。

## 必須ルールと書式

- **英語ハブ名の併記:**
  - クラス名、インターフェース名、列挙型名など、AIによる翻訳対象となる「翻訳用語」については、**必ず確定した英語ハブ名を括弧 `()` 内に併記**する必要があります。
  - 英語ハブ名は、`english_specification.md` で定義された**英語命名規則**に従います。
  - 翻訳用語の母国語表記は、対象言語の翻訳ルール (`translation_rules/` 内) で定義された**標準命名規則**に従います。
  - 書式: `#### {標準母国語名} ({確定英語ハブ名})`
  - 例 (日本語の場合): `#### 顧客クラス (Customer)`
  - 例 (フランス語の場合を想定): `#### Classe Client (Customer)`
- **厳密な命名規則の適用:**
  - 上記の通り、母国語名と英語ハブ名の両方について、それぞれの言語で定義された**標準命名規則を厳密に適用**する必要があります。
  - モジュール名は、`english_specification.md` で定義された英語命名規則に従い、グローバルな一意性を確保することが強く推奨されます。
- **モジュール定義の必須化:**
  - 全ての定義（クラス、インターフェース、列挙型など）は、必ず**モジュール (`## module.name`)** の下に記述する必要があります。グローバルトップレベルに直接定義することはできません。
- **構造:**
  - モジュール内にオプションで**セクション (`###` 以下)** を使用して構造化することは可能です (共通仕様参照)。
- **クロス参照:**
  - **同一モジュール内:** 参照したいクラス名などを、定義フォーマットの表記（例: `{標準母国語名} ({確定英語ハブ名})`）ではなく、**標準母国語名のみ**で記述します。AIは文脈からモジュール内の定義を特定します。（例: `タスクリスト (List<タスククラス>)`）
  - **異なるモジュール:** 参照したいクラス等が別のモジュールに属する場合、**必ず完全修飾名 (`モジュール名.クラス名`)** で指定する必要があります。型指定の場合も同様です。（例: `作成者 (com.example.common.User)`）
- **要素定義キーワード:**
  - `format_common.md` に記載の通り、**言語ごとの基本用語**を使用します。
  - **継承:**
    - 書式 (日本語例): `**基底クラス:** {基底クラス名} ({英語基底クラス名})`
    - 書式 (英語例): `**Base Class:** {BaseClassName}`
  - **インターフェース実装:**
    - 書式 (日本語例): `**インターフェース:** {インターフェース名} ({英語インターフェース名}), ...`
    - 書式 (英語例): `**Interfaces:** {InterfaceName}, ...`
- **オプション項目とデフォルト値:**
  - プロパティ定義では、型名の後に `, {オプション指示子}` を追記することで任意項目を示すことができます（オプション指示子の用語は `core.md` 参照）。
    - 例 (日本語): `- プロパティ名 (String, オプション)`
    - 例 (英語): `- propertyName (String, Optional)`
  - メソッド定義では、引数の型名の後に `= {初期値}` を追記することでデフォルト値を表現できます。リテラル値 (`True`, `False`, `Null`, 数値, 文字列) のみが推奨されます。
    - 例 (日本語): `- メソッド名(引数名: Number = 0): Void`
    - 例 (英語): `- methodName(argumentName: Number = 0): Void`
- **説明文の推奨:**
  - 各モジュール、セクション、クラス、インターフェース、メソッド、プロパティなどには、その目的や意味を明確にするための**説明文を記述することを強く推奨**します。AIの解釈補助や人間による理解促進に役立ちます。説明文はプロンプト記述言語で記述します。

## 出力ルール

- AIが `定義フォーマット` で出力を指示された場合は、**必ずOOPD形式(Markdown形式)の出力全体をコードブロック「\`\`\`」を使用して囲んで表示**してください。
- インスタンスのデータを出力する際は、標準として**YAML形式のコードブロック（`---yaml` ... `---`）**で出力します。ユーザーが別途指示をした場合はJSON等の他の形式でも構いません。

## 定義フォーマットの確定プロセス

- 通常、`定義フォーマット` は、ユーザーが `ユーザーフォーマット` で作成した内容を基に、AIに生成を指示します。
- AIは生成時に、上記の必須ルール（英語名併記、命名規則、モジュール所属など）への準拠を自動チェックします。
- チェックで問題が見つかった場合（例: 命名規則違反、英語名不明瞭、モジュール未定義など）、AIはユーザーに問題点を指摘し、修正を促します。AIが修正案を提示する場合もあります。
- ユーザーがAIとの対話を通じて問題を解消し、内容を確認・承認することで、`定義フォーマット` が確定します。
